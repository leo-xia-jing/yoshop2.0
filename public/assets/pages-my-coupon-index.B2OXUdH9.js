import{_ as e}from"./u-tabs.DDpHGTt6.js";import{m as a,p as s,q as t,c as l,w as o,n,i as u,o as c,a as i,b as p,d,F as r,k as m,f as _,t as f,e as h,l as y}from"./index-Drdq8Rgk.js";import{r as b}from"./uni-app.es.D6sSmWWN.js";import{M as x,_ as C}from"./mescroll-mixins.Bqk3PzlT.js";import{l as T}from"./myCoupon.1vcYf6qR.js";import{C as g}from"./CouponType.Dp06JTq7.js";import{_ as k}from"./_plugin-vue_export-helper.BCo6x5W8.js";const v=[{name:"未使用",value:"isUnused"},{name:"已使用",value:"isUse"},{name:"已过期",value:"isExpire"}];const U=k({mixins:[x],data:()=>({CouponTypeEnum:g,tabs:v,curTab:0,list:a(),upOption:{auto:!0,page:{size:15},noMoreSize:4,empty:{tip:"亲，暂无相关优惠券"}}}),onLoad(e){},methods:{upCallback(e){const a=this;a.getCouponList(e.num).then((e=>{const s=e.data.length,t=e.data.total;a.mescroll.endBySize(s,t)})).catch((()=>a.mescroll.endErr()))},getCouponList(e=1){const a=this;return new Promise(((t,l)=>{T({dataType:a.getTabValue(),page:e},{load:!1}).then((l=>{const o=l.data.list;a.list.data=s(o,a.list,e),t(o)}))}))},getTabValue(){return this.tabs[this.curTab].value},onChangeTab(e){this.curTab=e,this.onRefreshList()},onRefreshList(){this.list=a(),setTimeout((()=>{this.mescroll.resetUpScroll()}),120)},handleDescribe(e){this.list.data[e].expand=!this.list.data[e].expand}}},[["render",function(a,s,x,T,g,k){const v=b(t("u-tabs"),e),U=y,L=u,j=b(t("mescroll-body"),C);return c(),l(L,{class:"container",style:n(a.appThemeStyle)},{default:o((()=>[i(j,{ref:"mescrollRef",sticky:!0,onInit:a.mescrollInit,down:{use:!1},up:g.upOption,onUp:k.upCallback},{default:o((()=>[i(v,{list:g.tabs,"is-scroll":!1,modelValue:g.curTab,"onUpdate:modelValue":s[0]||(s[0]=e=>g.curTab=e),"active-color":a.appTheme.mainBg,duration:.2,onChange:k.onChangeTab},null,8,["list","modelValue","active-color","onChange"]),i(L,{class:"coupon-list"},{default:o((()=>[(c(!0),p(r,null,d(g.list.data,((e,a)=>(c(),l(L,{class:"coupon-item",key:a},{default:o((()=>[i(L,{class:m(["item-wrapper",[e.state.value?"":"disable"]])},{default:o((()=>[i(L,{class:"coupon-tag"},{default:o((()=>[i(U,null,{default:o((()=>[_(f(g.CouponTypeEnum[e.coupon_type].name),1)])),_:2},1024)])),_:2},1024),i(L,{class:"coupon-left"},{default:o((()=>[i(L,{class:"coupon-reduce"},{default:o((()=>[i(L,{class:"coupon-reduce-unit"},{default:o((()=>[i(U,null,{default:o((()=>[_("￥")])),_:1})])),_:1}),i(L,{class:"coupon-reduce-amount"},{default:o((()=>[i(U,{class:"value"},{default:o((()=>[_(f(e.reduce_price),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),i(U,{class:"coupon-hint"},{default:o((()=>[_("满"+f(e.min_price)+"元可用",1)])),_:2},1024)])),_:2},1024),i(L,{class:"coupon-content"},{default:o((()=>[i(L,{class:"coupon-name"},{default:o((()=>[_(f(e.name),1)])),_:2},1024),i(L,{class:"coupon-middle"},{default:o((()=>[i(L,{class:"coupon-expire"},{default:o((()=>[e.expire_type==g.CouponTypeEnum.FULL_DISCOUNT.value?(c(),l(U,{key:0},{default:o((()=>[_("领取后"+f(e.expire_day)+"天内有效",1)])),_:2},1024)):h("",!0),e.expire_type==g.CouponTypeEnum.DISCOUNT.value?(c(),l(U,{key:1},{default:o((()=>[e.start_time===e.end_time?(c(),p(r,{key:0},[_(f(e.start_time)+" 当天有效",1)],64)):(c(),p(r,{key:1},[_(f(e.start_time)+"~"+f(e.end_time),1)],64))])),_:2},1024)):h("",!0)])),_:2},1024)])),_:2},1024),e.describe?(c(),l(L,{key:0,class:"coupon-expand",onClick:e=>k.handleDescribe(a)},{default:o((()=>[i(U,null,{default:o((()=>[_("使用说明")])),_:1}),i(U,{class:m(["coupon-expand-arrow iconfont icon-arrow-down",[e.expand?"expand":""]])},null,8,["class"])])),_:2},1032,["onClick"])):h("",!0)])),_:2},1024),i(L,{class:"coupon-right"},{default:o((()=>[e.state.value?h("",!0):(c(),l(L,{key:0,class:"state-text"},{default:o((()=>[i(U,null,{default:o((()=>[_(f(e.state.text),1)])),_:2},1024)])),_:2},1024))])),_:2},1024)])),_:2},1032,["class"]),i(L,{class:m([[e.expand?"expand":""],"coupon-expand-rules"])},{default:o((()=>[i(L,{class:"coupon-expand-rules-content"},{default:o((()=>[i(L,{class:"pre"},{default:o((()=>[_(f(e.describe),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1024)))),128))])),_:1})])),_:1},8,["onInit","up","onUp"])])),_:1},8,["style"])}],["__scopeId","data-v-955f4e33"]]);export{U as default};
